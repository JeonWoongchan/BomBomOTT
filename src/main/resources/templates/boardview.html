<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>게시글 상세 페이지</title>
</head>
<body>

<h1 th:text="${board.title}">제목입니다.</h1>
<p th:text="${board.content}">내용이 들어갈 부분입니다.</p>
<a th:href="@{${board.filepath}}">다운받기</a>
<a th:href="@{/board/modify/{id}(id = ${board.id})}">수정</a>
<a th:href="@{/board/delete/(id = ${board.id})}">삭제</a>
<p>좋아요 수: <span id="likeCount" th:text="${board.likeCount}">0</span></p>

<button th:if="${board.likeCount == 0}" onclick="likeBoard()">좋아요</button>
<button th:if="${board.likeCount == 1}" onclick="likeBoard()">좋아요</button>

<script>
    function likeBoard() {
        const boardId = [[${board.id}]];
        const likeCountElement = document.getElementById('likeCount');

        const xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function () {
            if (xhr.readyState === XMLHttpRequest.DONE) {
                if (xhr.status === 200) {

                    const newLikeCount = parseInt(likeCountElement.innerText);
                    likeCountElement.innerText = newLikeCount === 1 ? 0 : 1;

                    const likeButton = document.getElementById('likeButton');
                    likeButton.disabled = false;
                } else {
                    alert('좋아요 요청에 실패했습니다.');
                }
            }
        };
        xhr.open('POST', '/board/like/' + boardId);
        xhr.send();
    }
</script>

</body>





</html>